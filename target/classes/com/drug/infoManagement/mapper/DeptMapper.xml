<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="com.drug.infoManagement.mapper.DeptMapper">
	
	<!-- 查询部门信息 -->
	<select id="queryAllDept" parameterType="Map" resultType="MainDepartment">
		select * from 
		(
			select * from main_department where deptState='未删除'
			limit #{page},#{limit}
		)dept 
		order by dept.deptId desc
	</select>
	
	<!-- 统计部门 -->
	<select id="queryCountDept" resultType="Integer">
		select count(*) from main_department where deptState='未删除'
	</select>
	
	<!-- 通过部门名称查询部门对象 -->
	<select id="queryDeptByName" parameterType="MainDepartment" resultType="MainDepartment">
		select * from main_department where deptName=#{deptName}
	</select>
	
	<!-- 通过部门名称修改部门状态 -->
	<update id="updateDeptById" parameterType="MainDepartment">
		update main_department 
		set 
		deptName=#{deptName},deptDesc=#{deptDesc},deptState='未删除' 
		where deptId=#{deptId}
	</update>
	
	<!-- 添加部门 -->
	<insert id="addDept" parameterType="MainDepartment">
		insert into main_department(deptName,deptDesc) values(#{deptName},#{deptDesc})
	</insert>
	
	<!-- 删除部门 -->
	<delete id="deletDeptById" parameterType="String">
		delete from main_department where deptId=#{deptId}
	</delete>
	
	<!-- 通过部门Id修改员工表的部门Id -->
	<update id="updateEmpByDeptId" parameterType="String">
		update main_employee set deptId=0 where deptId=#{deptId}
	</update>
	
	
</mapper>
